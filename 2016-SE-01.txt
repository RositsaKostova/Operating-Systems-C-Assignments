2016-SE-01
Напишете програма на C, която приема параметър - име на (двоичен) файл с байтове.
Програмата трябва да сортира файла

#include <unistd.h>
#include <err.h>
#include <stdint.h>
#include <fcntl.h>

int main(int argc, char* argv[]) {
    if (argc != 2) {
        errx(1, "A binary file expected!\n");
    }

    const char* file_name = argv[1];
    int fd = open(file_name, O_RDWR);
    if (fd == -1) {
        err(2, "Could not open file %s!\n", file_name);
    }
    uint32_t bytes[256] = {0};
    uint8_t current_byte;
    ssize_t read_bytes;
    while((read_bytes = read(fd, &current_byte, sizeof(current_byte))) > 0) {
        bytes[current_byte]++;
    }
    if(read_bytes == -1) {
        err(3, "Could not read properly from file %s!\n", file_name);
    }

    off_t position = lseek(fd, 0, SEEK_SET);
    if(position == -1) {
        err(5, "Could not lseek properly in file %s!\n", file_name);
    }

    for(int i = 0; i < 256; i++) {
        uint8_t byte = i;
        for(uint32_t j = 0; j < bytes[i]; j++) {
           ssize_t written_bytes = write(fd, &byte, sizeof(byte));
           if(written_bytes == -1) {
                err(4, "Could not write properly in file %s!\n", file_name);
           }
        }
    }

    close(fd);
    return 0;
}
