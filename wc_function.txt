//Реализирайте команда wc, с един аргумент подаден като входен параметър.


#include <stdio.h>
#include <stdint.h>
#include <unistd.h>
#include <fcntl.h>
#include <err.h>
#include <string.h>

int main(int argc, char** argv) {
        if (argc != 2) {
        errx(1, "A regular file expected!");
        }
        const char* file = argv[1];
        int fd = open(file, O_RDONLY);
        if (fd == -1) {
        err(2, "Could not open file %s!\n", file);
        }

        char symbol;
        ssize_t read_byte;
        uint16_t new_line_counter = 0;
        uint16_t words_counter = 0;
        uint32_t bytes_counter = 0;
        uint8_t letters_counter = 0;
        while((read_byte = read(fd, &symbol, sizeof(symbol))) > 0) {
        bytes_counter++;
        if (symbol == '\t' || symbol == '\n' || symbol == '\r' || symbol == '\v' || symbol == '\f' || symbol == ' ') {
            if (symbol == '\n') {
                new_line_counter++;
            }
            if (letters_counter != 0) {
                words_counter++;
                letters_counter = 0;
            }
        }
        else {
            letters_counter++;
        }
        }

    if(read_byte == -1) {
        close(fd);
        err(4, "Could not read properly from file %s!\n", file);
    }
    close(fd);
    char buffer[300];
    snprintf(buffer, sizeof(buffer), "File %s consists of %d lines, %d words and %d bytes\n", file, new_line_counter, words_counter, bytes_counter);
    ssize_t written_bytes_count = write(1, buffer, strlen(buffer));
    if (written_bytes_count == -1) {
        err(3, "Could not write properly to stdout!");
    }
        return 0;
}
